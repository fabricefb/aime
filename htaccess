# Configuration Apache pour Django - AIME Website
# Domaine: aime-rdc.org

RewriteEngine On

# Force HTTPS (seulement en production)
# RewriteCond %{HTTPS} off
# RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Redirection www vers non-www
RewriteCond %{HTTP_HOST} ^www\.aime-rdc\.org [NC]
RewriteRule ^(.*)$ https://aime-rdc.org/$1 [L,R=301]

# Servir les fichiers statiques directement
RewriteRule ^static/(.*)$ staticfiles/$1 [L]
RewriteRule ^media/(.*)$ media/$1 [L]

# Configuration pour Django (apr√®s les fichiers statiques)
RewriteCond %{REQUEST_URI} !^/static/
RewriteCond %{REQUEST_URI} !^/media/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ passenger_wsgi.py/$1 [QSA,L]

# Protection des fichiers sensibles
<Files "*.py">
    Require all denied
</Files>

<Files "*.pyc">
    Require all denied
</Files>

<Files "db.sqlite3">
    Require all denied
</Files>

# Configuration pour les fichiers statiques
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType image/jpg "access plus 1 month"
    ExpiresByType image/jpeg "access plus 1 month"
    ExpiresByType image/gif "access plus 1 month"
    ExpiresByType image/png "access plus 1 month"
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/pdf "access plus 1 month"
    ExpiresByType text/javascript "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
</IfModule>
